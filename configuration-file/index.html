
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://micheltokic.github.io/stable_baselines_model_based_rl/configuration-file/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.8">
    
    
      
        <title>Configuration File - Stable Baselines - Model Based Reinforcement Learning</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.92558b1b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#configuration-file" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Stable Baselines - Model Based Reinforcement Learning" class="md-header__button md-logo" aria-label="Stable Baselines - Model Based Reinforcement Learning" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Stable Baselines - Model Based Reinforcement Learning
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Configuration File
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/micheltokic/stable_baselines_model_based_rl/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Project on GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link md-tabs__link--active">
        Documentation
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../api/" class="md-tabs__link">
        API Reference
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Stable Baselines - Model Based Reinforcement Learning" class="md-nav__button md-logo" aria-label="Stable Baselines - Model Based Reinforcement Learning" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Stable Baselines - Model Based Reinforcement Learning
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/micheltokic/stable_baselines_model_based_rl/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Project on GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" checked>
      
      <label class="md-nav__link" for="__nav_1">
        Documentation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Documentation" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home / Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_3" data-md-state="indeterminate" type="checkbox" id="__nav_1_3" checked>
      
      <label class="md-nav__link" for="__nav_1_3">
        Using the Framework
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Using the Framework" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_3">
          <span class="md-nav__icon md-icon"></span>
          Using the Framework
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../sampling/" class="md-nav__link">
        Gym Sampling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic-model-training/" class="md-nav__link">
        Dynamic Model Training/Creation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../environment-wrapping/" class="md-nav__link">
        Create wrapped Gym Environment
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../policy-training/" class="md-nav__link">
        Policy Training (with Stable Baselines)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Configuration File
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Configuration File
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#gym-environment-sampling" class="md-nav__link">
    Gym Environment Sampling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-data-configuration" class="md-nav__link">
    Input Data Configuration
  </a>
  
    <nav class="md-nav" aria-label="Input Data Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-of-action-columns" class="md-nav__link">
    Configuration of Action Columns
  </a>
  
    <nav class="md-nav" aria-label="Configuration of Action Columns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#type-of-action" class="md-nav__link">
    Type of Action
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-discrete-action" class="md-nav__link">
    Multi Discrete Action
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#box-actions" class="md-nav__link">
    Box Actions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamic-model-creation-training" class="md-nav__link">
    Dynamic Model Creation / Training
  </a>
  
    <nav class="md-nav" aria-label="Dynamic Model Creation / Training">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#training" class="md-nav__link">
    Training
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keras-model-configuration" class="md-nav__link">
    Keras Model Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validation" class="md-nav__link">
    Validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utility-flags" class="md-nav__link">
    Utility Flags
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-wrapping" class="md-nav__link">
    Model Wrapping
  </a>
  
    <nav class="md-nav" aria-label="Model Wrapping">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reward-configuration" class="md-nav__link">
    Reward Configuration
  </a>
  
    <nav class="md-nav" aria-label="Reward Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constant-reward-handling" class="md-nav__link">
    Constant Reward-Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eval-reward-handling" class="md-nav__link">
    Eval Reward-Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handler-reward-handling" class="md-nav__link">
    Handler Reward-Handling
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#done-configuration" class="md-nav__link">
    Done Configuration
  </a>
  
    <nav class="md-nav" aria-label="Done Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constant-done-handling" class="md-nav__link">
    Constant Done-Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eval-done-handling" class="md-nav__link">
    Eval Done-Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handler-done-handling" class="md-nav__link">
    Handler Done-Handling
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reset-configuration" class="md-nav__link">
    Reset Configuration
  </a>
  
    <nav class="md-nav" aria-label="Reset Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#random-reset-handling" class="md-nav__link">
    Random Reset-Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-reset-handling" class="md-nav__link">
    Static Reset-Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#episode-start-reset-handling" class="md-nav__link">
    Episode-Start Reset-Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handler-reset-handling" class="md-nav__link">
    Handler Reset-Handling
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#policy-configuration" class="md-nav__link">
    Policy Configuration
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        Command Line Interface
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" data-md-state="indeterminate" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        API Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/cli.context/" class="md-nav__link">
        Cli.context
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/cli/" class="md-nav__link">
        Cli
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/cli.sb_mbrl/" class="md-nav__link">
        Cli.sb mbrl
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/cli.sb_mbrl_eval/" class="md-nav__link">
        Cli.sb mbrl eval
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/cli.sb_mbrl_obtain_config_file/" class="md-nav__link">
        Cli.sb mbrl obtain config file
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/dynamic_model_trainer.dynamic_model_trainer/" class="md-nav__link">
        Dynamic model trainer.dynamic model trainer
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/dynamic_model_trainer/" class="md-nav__link">
        Dynamic model trainer
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/dynamic_model_trainer.model_builder/" class="md-nav__link">
        Dynamic model trainer.model builder
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/dynamic_model_trainer.prepare_data/" class="md-nav__link">
        Dynamic model trainer.prepare data
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/dynamic_model_trainer.tensorflow_data_generator/" class="md-nav__link">
        Dynamic model trainer.tensorflow data generator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/dynamic_model_trainer.training/" class="md-nav__link">
        Dynamic model trainer.training
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/dynamic_model_trainer.verifier/" class="md-nav__link">
        Dynamic model trainer.verifier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/sampler.gym_sampler/" class="md-nav__link">
        Sampler.gym sampler
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/sampler/" class="md-nav__link">
        Sampler
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/sb_training/" class="md-nav__link">
        Sb training
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/sb_training.stable_baselines_policy_trainer/" class="md-nav__link">
        Sb training.stable baselines policy trainer
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils.configuration/" class="md-nav__link">
        Utils.configuration
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils.mean/" class="md-nav__link">
        Utils.mean
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils.noise/" class="md-nav__link">
        Utils.noise
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils.spaces.base/" class="md-nav__link">
        Utils.spaces.base
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils.spaces.box/" class="md-nav__link">
        Utils.spaces.box
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils.spaces.discrete/" class="md-nav__link">
        Utils.spaces.discrete
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils.spaces.factory/" class="md-nav__link">
        Utils.spaces.factory
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils.spaces/" class="md-nav__link">
        Utils.spaces
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils.test_functions/" class="md-nav__link">
        Utils.test functions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/wrapper.gym_step_handlers.acrobot/" class="md-nav__link">
        Wrapper.gym step handlers.acrobot
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/wrapper.gym_step_handlers.cartpole/" class="md-nav__link">
        Wrapper.gym step handlers.cartpole
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/wrapper.gym_step_handlers.continuous_mountain_car/" class="md-nav__link">
        Wrapper.gym step handlers.continuous mountain car
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/wrapper.gym_step_handlers/" class="md-nav__link">
        Wrapper.gym step handlers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/wrapper.gym_step_handlers.mountain_car/" class="md-nav__link">
        Wrapper.gym step handlers.mountain car
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/wrapper.gym_step_handlers.pendulum/" class="md-nav__link">
        Wrapper.gym step handlers.pendulum
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/wrapper/" class="md-nav__link">
        Wrapper
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/wrapper.reset_handler/" class="md-nav__link">
        Wrapper.reset handler
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/wrapper.step_handler/" class="md-nav__link">
        Wrapper.step handler
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api/wrapper.wrapped_model_env/" class="md-nav__link">
        Wrapper.wrapped model env
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#gym-environment-sampling" class="md-nav__link">
    Gym Environment Sampling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-data-configuration" class="md-nav__link">
    Input Data Configuration
  </a>
  
    <nav class="md-nav" aria-label="Input Data Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-of-action-columns" class="md-nav__link">
    Configuration of Action Columns
  </a>
  
    <nav class="md-nav" aria-label="Configuration of Action Columns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#type-of-action" class="md-nav__link">
    Type of Action
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-discrete-action" class="md-nav__link">
    Multi Discrete Action
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#box-actions" class="md-nav__link">
    Box Actions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamic-model-creation-training" class="md-nav__link">
    Dynamic Model Creation / Training
  </a>
  
    <nav class="md-nav" aria-label="Dynamic Model Creation / Training">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#training" class="md-nav__link">
    Training
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keras-model-configuration" class="md-nav__link">
    Keras Model Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validation" class="md-nav__link">
    Validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utility-flags" class="md-nav__link">
    Utility Flags
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-wrapping" class="md-nav__link">
    Model Wrapping
  </a>
  
    <nav class="md-nav" aria-label="Model Wrapping">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reward-configuration" class="md-nav__link">
    Reward Configuration
  </a>
  
    <nav class="md-nav" aria-label="Reward Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constant-reward-handling" class="md-nav__link">
    Constant Reward-Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eval-reward-handling" class="md-nav__link">
    Eval Reward-Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handler-reward-handling" class="md-nav__link">
    Handler Reward-Handling
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#done-configuration" class="md-nav__link">
    Done Configuration
  </a>
  
    <nav class="md-nav" aria-label="Done Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constant-done-handling" class="md-nav__link">
    Constant Done-Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eval-done-handling" class="md-nav__link">
    Eval Done-Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handler-done-handling" class="md-nav__link">
    Handler Done-Handling
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reset-configuration" class="md-nav__link">
    Reset Configuration
  </a>
  
    <nav class="md-nav" aria-label="Reset Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#random-reset-handling" class="md-nav__link">
    Random Reset-Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-reset-handling" class="md-nav__link">
    Static Reset-Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#episode-start-reset-handling" class="md-nav__link">
    Episode-Start Reset-Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handler-reset-handling" class="md-nav__link">
    Handler Reset-Handling
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#policy-configuration" class="md-nav__link">
    Policy Configuration
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/micheltokic/stable_baselines_model_based_rl/edit/master/docs/configuration-file.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="configuration-file">Configuration File</h1>
<p>The configuration file is a yaml file containing all required parameters used by
different parts of the library.</p>
<p>Different sections of the file are used by different components of the library,
such as the sampler, or for creating the dynamic model. Thus, not all configuration
options may be required to be adjusted by you, depending on what features of
the framework/library you use.<br />
The sampler will also create a (template) configuration file, based on the gym
environment that has been sampled.</p>
<p>A template/ example configuration file can be <a href="https://github.com/micheltokic/stable_baselines_model_based_rl/blob/main/example_usage/sample_config.yaml">viewed here</a>.</p>
<h2 id="gym-environment-sampling">Gym Environment Sampling</h2>
<div class="highlight"><pre><span></span><code><span class="nt">gym_sampling</span><span class="p">:</span>
    <span class="nt">gym_environment_name</span><span class="p">:</span> <span class="s">&#39;CartPole-v1&#39;</span>
</code></pre></div>
<p>This setting is only used by the CLI for sampling a gym environment and only in the case, that you
do not specify another environemnt to sample.</p>
<h2 id="input-data-configuration">Input Data Configuration</h2>
<h3 id="example">Example</h3>
<div class="highlight"><pre><span></span><code><span class="nt">input_config</span><span class="p">:</span>
    <span class="nt">action_cols</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">A_0</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">A_1</span>
    <span class="nt">action_type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DISCRETE</span>  <span class="c1"># one of: DISCRETE, MULTI_DISCRETE, BOX</span>
    <span class="nt">discrete_colum_sets</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
    <span class="nt">action_box_bounds</span><span class="p">:</span>
        <span class="nt">low</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
        <span class="nt">high</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
    <span class="nt">observation_cols</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">X_0</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">X_1</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">X_2</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">X_3</span>
    <span class="nt">observation_bounds</span><span class="p">:</span>
        <span class="nt">low</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
        <span class="nt">high</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
    <span class="nt">input_file_name</span><span class="p">:</span> <span class="s">&#39;train.csv&#39;</span>
</code></pre></div>
<h3 id="configuration-of-action-columns">Configuration of Action Columns</h3>
<p>List including all CSV-Headers of columns, that represent actions.
<div class="highlight"><pre><span></span><code><span class="nt">input_config</span><span class="p">:</span>
    <span class="nt">action_cols</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">A_0</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">A_1</span>
    <span class="nt">action_type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DISCRETE</span>
    <span class="nt">discrete_column_sets</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
    <span class="nt">action_box_bounds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
</code></pre></div></p>
<h4 id="type-of-action">Type of Action</h4>
<p>Either DISCRETE, MULTI_DISCRETE, or BOX.
For DISCRETE, all action columns represent of of the possible discrete actions. For MULTI_DISCRETE and BOX,
the respective configuration keys (<code>discrete_colum_sets</code>, <code>action_box_bounds</code>) must be additionally defined.
See explanations next.</p>
<h4 id="multi-discrete-action">Multi Discrete Action</h4>
<p><mark class="critic"><strong>Note</strong>: Multi-Discrete Actions are not yet supported!</mark><br />
It must be specified, which columns belong to which discrete action:
<div class="highlight"><pre><span></span><code><span class="nt">input_config</span><span class="p">:</span>
    <span class="nt">action_cols</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">A_0_0</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">A_0_1</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">A_1_0</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">A_1_1</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">A_1_2</span>
    <span class="nt">action_type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MULTI_DISCRETE</span>
    <span class="nt">discrete_column_sets</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span> <span class="nv">A_0_0</span><span class="p p-Indicator">,</span> <span class="nv">A_0_1</span> <span class="p p-Indicator">]</span>
        <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span> <span class="nv">A_1_0</span><span class="p p-Indicator">,</span> <span class="nv">A_1_1</span><span class="p p-Indicator">,</span> <span class="nv">A_1_2</span> <span class="p p-Indicator">]</span>
    <span class="nt">action_box_bounds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
</code></pre></div>
This configuration would represent a multi discrete action consisting of two discrete actions. The first of which would have two discrete actions (A_0_0, A_0_1), the second would have three discrete actions (A_1_0, A_1_1, A_1_2).</p>
<h4 id="box-actions">Box Actions</h4>
<p>The bounds of the input box must be specified by two lists: one for minimum values, one for
maximum values.<br />
<div class="highlight"><pre><span></span><code><span class="nt">input_config</span><span class="p">:</span>
    <span class="nt">action_cols</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">A_1</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">A_2</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">A_3</span>
    <span class="nt">action_type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">BOX</span>
    <span class="nt">discrete_column_sets</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
    <span class="nt">action_box_bounds</span><span class="p">:</span>
        <span class="nt">low</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span> <span class="nv">3</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">]</span>
        <span class="nt">high</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">5</span><span class="p p-Indicator">,</span> <span class="nv">3</span><span class="p p-Indicator">]</span>
</code></pre></div>
This configuration represents three input actions, the first of which is between -1 and 3, the
second between 3 and 5 and the third between 0 and 3.</p>
<h2 id="dynamic-model-creation-training">Dynamic Model Creation / Training</h2>
<h3 id="training">Training</h3>
<p>The <code>dynamic_model.training</code> section configures how the training of the dynamic model is
performed:</p>
<div class="highlight"><pre><span></span><code><span class="nt">dynamic_model</span><span class="p">:</span>
    <span class="nt">training</span><span class="p">:</span>
        <span class="nt">train_test_ration</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.7</span>  <span class="c1"># 0.7: 70% of the data is used for training, 30% for testing</span>
        <span class="nt">lag</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4</span>
        <span class="nt">validation_steps</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
        <span class="nt">validation_freq</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
        <span class="nt">max_epochs</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">50</span>
        <span class="nt">steps_per_epoch</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
        <span class="nt">learning_rate</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.05</span>
        <span class="nt">optimizer</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">adam</span>
        <span class="nt">batch_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">64</span>
        <span class="nt">patience</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">15</span>  <span class="c1"># Epochs in which no learning success is achieved, after which the training is discontinued</span>
</code></pre></div>
<p>For more details the <a href="https://keras.io/api/models/model_training_apis/">corresponding Keras Documentation</a>
might be helpful, too.</p>
<h3 id="keras-model-configuration">Keras Model Configuration</h3>
<p>Internally, for the creation of the tensorflow model the <code>tf.keras.models.model_from_yaml</code>
method is used. Thus, you can configure your network architecture easily by providing a
proper configuration. (Also see the
<a href="https://www.tensorflow.org/api_docs/python/tf/keras/models/model_from_yaml">Keras Docs</a>.)</p>
<div class="highlight"><pre><span></span><code><span class="nt">dynamic_model</span><span class="p">:</span>
    <span class="nt">keras_model</span><span class="p">:</span> 
        <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Sequential</span>
        <span class="nt">config</span><span class="p">:</span>
            <span class="nt">name</span><span class="p">:</span> <span class="s">&#39;my_net&#39;</span>
            <span class="nt">layers</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">LSTM</span>
              <span class="nt">config</span><span class="p">:</span>
                <span class="nt">units</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">50</span>
</code></pre></div>
<h3 id="validation">Validation</h3>
<p>Currently the validation only contains noise configurations that are used later on in the prepare_data function.
Those configurations determine how the training data is modified to simulate noise. The percentage variable defines
how much of the data is changed and ranges between 0 and 1. The gaussian normal distribution 
requires a standard deviation (std) and mean value. If calc_mean is set to true the mean value of a column is calculated and used.
If set to False however, the mean value of the normal distribution is each column value.
<div class="highlight"><pre><span></span><code><span class="nt">dynamic_model</span><span class="p">:</span>
    <span class="nt">validation</span><span class="p">:</span>
        <span class="nt">noise</span><span class="p">:</span>
            <span class="nt">calc_mean</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
            <span class="nt">std</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.1</span>
            <span class="nt">percentage</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.5</span>
</code></pre></div></p>
<h3 id="utility-flags">Utility Flags</h3>
<p>The artificial noise decides whether an artificial noise is added to the data.
<div class="highlight"><pre><span></span><code><span class="nt">dynamic_model</span><span class="p">:</span>
    <span class="nt">utility_flags</span><span class="p">:</span>
        <span class="nt">log_training</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
        <span class="nt">save</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
        <span class="nt">evaluate_model</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
        <span class="nt">plot_results</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
        <span class="nt">export_model</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
        <span class="nt">artificial_noise</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
</code></pre></div></p>
<h2 id="model-wrapping">Model Wrapping</h2>
<p>Configuration for the Model Wrapping is required for three parts of the wrapping: Reward-, Done-,
and Reset-Handling.</p>
<h3 id="example_1">Example</h3>
<div class="highlight"><pre><span></span><code><span class="nt">model_wrapping</span><span class="p">:</span>
    <span class="nt">reward</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">CONSTANT</span>  <span class="c1"># one of CONSTANT, EVAL, or HANDLER</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1.0</span>
    <span class="nt">done</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">CONSTANT</span>  <span class="c1"># one of CONSTANT, EVAL, or HANDLER</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">200</span>
    <span class="nt">reset</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RANDOM</span>  <span class="c1"># one of RANDOM, STATIC, EPISODE_START, or HANDLER</span>
        <span class="nt">value</span><span class="p">:</span>
            <span class="nt">buffer</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
            <span class="nt">current_state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
        <span class="nt">data_file</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
</code></pre></div>
<h3 id="reward-configuration">Reward Configuration</h3>
<p>Three different types of Reward Configurations exist: Constant, Eval, and
Handler Reward-Handling.</p>
<h4 id="constant-reward-handling">Constant Reward-Handling</h4>
<p>Setting the <code>type</code> to <code>CONSTANT</code> requires to additionally set a <code>value</code> to a constant
float value. This is the constant reward given per step.<br />
<div class="highlight"><pre><span></span><code><span class="nt">model_wrapping</span><span class="p">:</span>
    <span class="nt">reward</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">CONSTANT</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4.5</span>
</code></pre></div></p>
<h4 id="eval-reward-handling">Eval Reward-Handling</h4>
<p>Setting the <code>type</code> to <code>EVAL</code> requires to additionally set a <code>value</code> to an eval expression
that is used to calculate the reward. The eval expression must be valid Python code. The
<a href="https://docs.python.org/3/library/functions.html#eval">Python eval-function</a> is used for
the calculation, respectively the given value-string is applied on the eval-function.
Within the context of the eval-function (i.e., within the given string/expression) the
current (new) state (observation) and the applied action (that lead to the new state)
are available via variables. The names of the variables are the ones given in the input-
configuration of the configuration file (<strong>action_cols</strong>, <strong>observation_cols</strong>).<br />
<div class="highlight"><pre><span></span><code><span class="nt">model_wrapping</span><span class="p">:</span>
    <span class="nt">reward</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">EVAL</span>
        <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;(A_0</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">A_1)</span><span class="nv"> </span><span class="s">/</span><span class="nv"> </span><span class="s">(X_0**2</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">X_1)&quot;</span>
</code></pre></div></p>
<h4 id="handler-reward-handling">Handler Reward-Handling</h4>
<p>If the <code>type</code> is set to <code>HANDLER</code>, the user is required to implement a custom handler
for reward-calulation, which allows a more complex calculation. For details, check out the
<a href="../environment-wrapping/#step-handler">docs section regarding the step handler</a>.<br />
<div class="highlight"><pre><span></span><code><span class="nt">model_wrapping</span><span class="p">:</span>
    <span class="nt">reward</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">HANDLER</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
</code></pre></div></p>
<h3 id="done-configuration">Done Configuration</h3>
<p>Three different types of Done Configurations exist: Constant, Eval, and
Handler Done-Handling.</p>
<h4 id="constant-done-handling">Constant Done-Handling</h4>
<p>Setting the <code>type</code> to <code>CONSTANT</code> requires to additionally set a <code>value</code> to a constant
int value. This is the constant amount of steps after which each episode ends.<br />
<div class="highlight"><pre><span></span><code><span class="nt">model_wrapping</span><span class="p">:</span>
    <span class="nt">done</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">CONSTANT</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">450</span>
</code></pre></div></p>
<h4 id="eval-done-handling">Eval Done-Handling</h4>
<p>Setting the <code>type</code> to <code>EVAL</code> requires to additionally set a <code>value</code> to an eval expression
that is used to calculate the done-state. It behaves similar to the
<a href="#eval-reward-handling">eval-reward calculation</a>
<div class="highlight"><pre><span></span><code><span class="nt">model_wrapping</span><span class="p">:</span>
    <span class="nt">done</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">EVAL</span>
        <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;(X_0</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">X_1)**2</span><span class="nv"> </span><span class="s">&gt;</span><span class="nv"> </span><span class="s">100&quot;</span>
</code></pre></div></p>
<h4 id="handler-done-handling">Handler Done-Handling</h4>
<p>If the <code>type</code> is set to <code>HANDLER</code>, the user is required to implement a custom handler
for done-calulation, which allows a more complex calculation. For details, check out the
<a href="../environment-wrapping/#step-handler">docs section regarding the step handler</a>.<br />
<div class="highlight"><pre><span></span><code><span class="nt">model_wrapping</span><span class="p">:</span>
    <span class="nt">done</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">HANDLER</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
</code></pre></div></p>
<h3 id="reset-configuration">Reset Configuration</h3>
<p>Four different types of Reset-Handling exist: Random-, Static-, Episode-Start-,
and Handler-Handling.</p>
<h4 id="random-reset-handling">Random Reset-Handling</h4>
<p>If the <code>type</code> is set to <code>RANDOM</code> the built-in (randomn) sampling of gym environments
is used to create the reset state/observation. If using a window_size &gt; 1 this
will most likely produce observations and actions that would not occur together
in the "regular environment". Thus, this handling is not accurate for larger
window_sizes.<br />
<div class="highlight"><pre><span></span><code><span class="nt">model_wrapping</span><span class="p">:</span>
    <span class="nt">reset</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RANDOM</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
        <span class="nt">data_file</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
</code></pre></div></p>
<h4 id="static-reset-handling">Static Reset-Handling</h4>
<p>If the <code>type</code> is set to <code>STATIC</code>, the same reset observation and state are used
for every reset. Depending on the window_size, a list of states must be given to
fill the buffer initally. Also, the current state/observation must be given. For
a window_size of 3, for example, 2 values for the buffer plus one current observation
must be given:<br />
<div class="highlight"><pre><span></span><code><span class="nt">model_wrapping</span><span class="p">:</span>
    <span class="nt">reset</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">STATIC</span>
        <span class="nt">value</span><span class="p">:</span>
            <span class="nt">buffer</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">1.0</span><span class="p p-Indicator">,</span> <span class="nv">2.0</span><span class="p p-Indicator">,</span> <span class="nv">3.0</span><span class="p p-Indicator">]</span>
              <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">1</span><span class="p p-Indicator">,</span> <span class="nv">2.0</span><span class="p p-Indicator">,</span> <span class="nv">3.0</span><span class="p p-Indicator">,</span> <span class="nv">2.5</span><span class="p p-Indicator">]</span>
            <span class="nt">current_state</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">0.5</span><span class="p p-Indicator">,</span> <span class="nv">2.0</span><span class="p p-Indicator">,</span> <span class="nv">1.0</span><span class="p p-Indicator">]</span>
        <span class="nt">data_file</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
</code></pre></div>
Note, that the buffer includes action and observation values (in the given order),
while the current_state only consists of an observation.</p>
<h4 id="episode-start-reset-handling">Episode-Start Reset-Handling</h4>
<p>If the <code>type</code> is set to <code>EPISODE_START</code>, the reset-state and observation is read
from a given data-file (format must equal the file used for training the modes; it
can also be the same file, of course). From the given file, one random episode is
chosen and used for the reset.
<div class="highlight"><pre><span></span><code><span class="nt">model_wrapping</span><span class="p">:</span>
    <span class="nt">reset</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">EPISODE_START</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
        <span class="nt">data_file</span><span class="p">:</span> <span class="s">&quot;/path/to/the/data/file.csv&quot;</span>
</code></pre></div></p>
<h4 id="handler-reset-handling">Handler Reset-Handling</h4>
<p>If the <code>type</code> is set to <code>HANDLER</code>, the user is required to implement a custom handler
for the calculation of reset states. This allows a more complex calculation. For details,
check out the <a href="../environment-wrapping/#reset-handler">docs section regarding the reset handler</a>.<br />
<div class="highlight"><pre><span></span><code><span class="nt">model_wrapping</span><span class="p">:</span>
    <span class="nt">reset</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">HANDLER</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
        <span class="nt">data_file</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
</code></pre></div></p>
<h2 id="policy-configuration">Policy Configuration</h2>
<p>The <code>sb_policy</code> section defines the parameters for the policy training with stable baselines
against the (wrapped) gym environment.<br />
You have three configuration options here:</p>
<ul>
<li><code>reinforcement_learning_algorithm</code>: The Algorithm to use for the model (e.g., PPO).</li>
<li><code>policy</code>: The policy to use (e.g., MlpPolicy).</li>
<li><code>timesteps</code>: Timesteps for the training/learning.</li>
</ul>
<p>For more details, check out the API docs and the docs of stable baselines.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../policy-training/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Policy Training (with Stable Baselines)" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Policy Training (with Stable Baselines)
            </div>
          </div>
        </a>
      
      
        
        <a href="../cli/" class="md-footer__link md-footer__link--next" aria-label="Next: Command Line Interface" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Command Line Interface
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand", "navigation.instant", "navigation.tabs"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.94ec81fe.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.48dfec6c.min.js"></script>
      
    
  </body>
</html>